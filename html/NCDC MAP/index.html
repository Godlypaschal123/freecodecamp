<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lassa Fever Cases by State — Nigeria (2020 NCDC)</title>
  <style>
    :root {
      --bg: #f6f7f9;
      --card: #ffffff;
      --muted: #6b7280;
      --accent1: #08306b;
      /* highest */
      --accent2: #2166ac;
      --accent3: #67a9cf;
      --accent4: #d1e7f7;
      /* lowest */
      --accent-none: #ffffff;
      --accent-border: #e6e9ef;
      --max-width: 1100px;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      color: #111827;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      max-width: var(--max-width);
      margin: 26px auto;
      background: var(--card);
      border-radius: 10px;
      box-shadow: 0 8px 20px rgba(16, 24, 40, 0.06);
      overflow: hidden;
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 24px;
      padding: 24px;
      align-items: start;
    }

    header h1 {
      margin: 0 0 6px 0;
      font-size: 20px;
      letter-spacing: -0.2px;
    }

    header p {
      margin: 0;
      color: var(--muted);
      font-size: 13px
    }

    /* map area */
    .map-wrap {
      padding: 8px;
      border-radius: 8px;
      background: linear-gradient(180deg, #ffffff, #fafbfd);
      border: 1px solid var(--accent-border);
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
    }

    .map-img {
      width: 100%;
      max-height: 680px;
      object-fit: contain;
      border-radius: 6px;
      border: 1px solid #eee;
      box-shadow: 0 6px 18px rgba(16, 24, 40, 0.04);
    }

    .caption {
      display: flex;
      width: 100%;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .caption .meta {
      color: var(--muted);
      font-size: 13px
    }

    .legend {
      width: 100%;
      display: flex;
      gap: 8px;
      align-items: center;
      justify-content: flex-end;
    }

    .legend .box {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .legend .swatch {
      width: 18px;
      height: 14px;
      border-radius: 3px;
      border: 1px solid #ddd;
    }

    /* right column */
    aside {
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--accent-border);
      background: #fff;
      height: fit-content;
    }

    .legend-panel h3 {
      margin: 0 0 8px 0;
      font-size: 16px;
    }

    .legend-grid {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 12px;
    }

    .legend-item {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .legend-color {
      width: 40px;
      height: 22px;
      border-radius: 4px;
      border: 1px solid #ddd;
      display: inline-block;
    }

    /* table */
    .table-wrap {
      border-top: 1px dashed #eef2f7;
      padding-top: 12px;
      margin-top: 8px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    th,
    td {
      padding: 8px 6px;
      text-align: left;
      border-bottom: 1px solid #f1f5f9;
    }

    th {
      font-weight: 600;
      color: var(--muted);
      font-size: 13px
    }

    tr:hover {
      background: #fbfdff;
      cursor: pointer;
    }

    tr.selected {
      background: linear-gradient(90deg, rgba(33, 102, 172, 0.06), rgba(33, 102, 172, 0.02));
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }

    .small {
      font-size: 12px;
      color: var(--muted)
    }

    .btn {
      display: inline-block;
      padding: 8px 12px;
      border-radius: 6px;
      border: 0;
      background: var(--accent2);
      color: white;
      font-weight: 600;
      font-size: 13px;
      text-decoration: none;
    }

    footer {
      margin-top: 14px;
      font-size: 12px;
      color: var(--muted)
    }

    /* modal details */
    .modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(2, 6, 23, 0.45);
      z-index: 80;
    }

    .modal .box {
      width: 480px;
      max-width: 94%;
      background: white;
      border-radius: 10px;
      padding: 18px;
      box-shadow: 0 20px 50px rgba(2, 6, 23, 0.4);
    }

    .modal .box h4 {
      margin: 0 0 8px 0
    }

    .modal .row {
      display: flex;
      justify-content: space-between;
      margin: 8px 0;
      color: var(--muted)
    }

    .close-x {
      position: absolute;
      right: 18px;
      top: 18px;
      color: white;
      font-size: 20px;
      cursor: pointer;
    }

    /* responsive */
    @media (max-width:980px) {
      .container {
        grid-template-columns: 1fr;
        padding: 16px;
      }

      aside {
        order: 2
      }
    }
  </style>
</head>

<body>

  <div class="container" role="main">
    <div>
      <header>
        <h1>Lassa fever cases — Nigeria (NCDC 2020 aggregated weekly reports)</h1>
        <p class="small">Map: your supplied choropleth. Legend and table below show aggregated suspected case counts
          (top states shown with numbers from the chart you provided). Death counts are <strong>not</strong> contained
          in your image — they are shown as "N/A" until you provide actual death numbers.</p>
      </header>

      <div class="map-wrap" aria-label="Map and legend">
        <!-- Put your original map file in same folder; adjust filename if yours is different -->
        <img id="mapImage" class="map-img" src="A_choropleth_map_of_Nigeria_illustrates_Lassa_feve.png"
          alt="Choropleth map of Nigeria showing Lassa fever cases by state (2020 NCDC)">
        <div class="caption">
          <div class="meta">Source: NCDC weekly 2020 (aggregated). Map: supplied by user.</div>
          <div class="legend" aria-hidden="true">
            <div class="box"><span class="swatch" style="background:var(--accent1)"></span><small class="small">151 –
                313 (Highest)</small></div>
            <div class="box"><span class="swatch" style="background:var(--accent2)"></span><small class="small">101 –
                150</small></div>
            <div class="box"><span class="swatch" style="background:var(--accent3)"></span><small class="small">51 –
                100</small></div>
            <div class="box"><span class="swatch" style="background:var(--accent4)"></span><small class="small">1 – 50
                (Low)</small></div>
            <div class="box"><span class="swatch"
                style="background:var(--accent-none); border:1px dashed #d7dbe4"></span><small class="small">No reported
                cases</small></div>
          </div>
        </div>
      </div>
    </div>

    <aside>
      <div class="legend-panel">
        <h3>Legend — case intensity</h3>
        <div class="legend-grid">
          <div class="legend-item"><span class="legend-color" style="background:var(--accent1)"></span>
            <div><strong>High</strong>
              <div class="small">151 – 313 suspected cases</div>
            </div>
          </div>
          <div class="legend-item"><span class="legend-color" style="background:var(--accent2)"></span>
            <div><strong>Moderately high</strong>
              <div class="small">101 – 150 suspected cases</div>
            </div>
          </div>
          <div class="legend-item"><span class="legend-color" style="background:var(--accent3)"></span>
            <div><strong>Moderate</strong>
              <div class="small">51 – 100 suspected cases</div>
            </div>
          </div>
          <div class="legend-item"><span class="legend-color" style="background:var(--accent4)"></span>
            <div><strong>Low</strong>
              <div class="small">1 – 50 suspected cases</div>
            </div>
          </div>
          <div class="legend-item"><span class="legend-color"
              style="background:var(--accent-none); border:1px dashed #d7dbe4"></span>
            <div><strong>No cases reported</strong>
              <div class="small">No suspected cases in supplied data</div>
            </div>
          </div>
        </div>

        <div class="table-wrap">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <strong>States — suspected case counts</strong>
            <button class="btn" id="downloadCsv">Download CSV</button>
          </div>
          <table id="statesTable" aria-describedby="tableDesc">
            <thead>
              <tr>
                <th>State</th>
                <th>Suspected cases</th>
                <th>Deaths (reported)</th>
              </tr>
            </thead>
            <tbody>
              <!-- populated by JS -->
            </tbody>
          </table>
          <p id="tableDesc" class="small">Click a row to view details. Case counts come from the bar chart you provided
            (top 12). Other states are shown as 0 or 'No reported cases' until you supply more data.</p>
        </div>

        <footer>
          <div class="small">Notes: If you want deaths added, upload NCDC death counts or provide a CSV and I will
            incorporate them. To highlight specific regions on the map image, provide an SVG with state shapes or a
            GeoJSON and I will produce an interactive map overlay.</div>
        </footer>
      </div>
    </aside>
  </div>

  <!-- modal for details -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="box" role="document">
      <h4 id="modalTitle">State details</h4>
      <div class="row">
        <div class="small">Suspected cases</div>
        <div id="modalCases" style="font-weight:700"></div>
      </div>
      <div class="row">
        <div class="small">Deaths (reported)</div>
        <div id="modalDeaths" style="font-weight:700"></div>
      </div>
      <div class="row">
        <div class="small">Notes</div>
        <div id="modalNotes" style="font-size:13px; color:var(--muted)"></div>
      </div>
      <div style="margin-top:12px; text-align:right"><button class="btn" id="closeModal">Close</button></div>
    </div>
  </div>

  <script>
    /*
      Data used in the table:
      - Suspected case counts are taken from the bar-chart image you provided for the 'Top 12 states' (Edo 313, Ondo 256, Taraba 47, Ebonyi 36, Bauchi 23, Plateau 21, Delta 16, Abia 13, Ogun 12, Kogi 11, Enugu 9, Borno 8).
      - All other states default to 0 / "No reported cases" (you can replace numbers as needed).
      - Death counts are not visible on the images you gave; they are set to "N/A". Provide a CSV or object with death counts if you want them included.
    */

    const statesData = {
      // Top 12 from your chart:
      "Edo": { cases: 313, deaths: "N/A" },
      "Ondo": { cases: 256, deaths: "N/A" },
      "Taraba": { cases: 47, deaths: "N/A" },
      "Ebonyi": { cases: 36, deaths: "N/A" },
      "Bauchi": { cases: 23, deaths: "N/A" },
      "Plateau": { cases: 21, deaths: "N/A" },
      "Delta": { cases: 16, deaths: "N/A" },
      "Abia": { cases: 13, deaths: "N/A" },
      "Ogun": { cases: 12, deaths: "N/A" },
      "Kogi": { cases: 11, deaths: "N/A" },
      "Enugu": { cases: 9, deaths: "N/A" },
      "Borno": { cases: 8, deaths: "N/A" }
    };

    // All 36 states — add ones missing with default 0
    const allStates = [
      "Abia", "Adamawa", "Akwa Ibom", "Anambra", "Bauchi", "Bayelsa", "Benue", "Borno",
      "Cross River", "Delta", "Ebonyi", "Edo", "Ekiti", "Enugu", "FCT", "Gombe", "Imo",
      "Jigawa", "Kaduna", "Kano", "Katsina", "Kebbi", "Kogi", "Kwara", "Lagos", "Nasarawa",
      "Niger", "Ogun", "Ondo", "Osun", "Oyo", "Plateau", "Rivers", "Sokoto", "Taraba", "Yobe", "Zamfara"
    ];

    // Ensure every state appears in statesData
    allStates.forEach(s => {
      if (!statesData[s]) statesData[s] = { cases: 0, deaths: "No reported deaths / N/A" };
    });

    // color ramp helper (returns hex)
    function colorForCases(n) {
      if (n >= 151) return getComputedStyle(document.documentElement).getPropertyValue('--accent1').trim();
      if (n >= 101) return getComputedStyle(document.documentElement).getPropertyValue('--accent2').trim();
      if (n >= 51) return getComputedStyle(document.documentElement).getPropertyValue('--accent3').trim();
      if (n >= 1) return getComputedStyle(document.documentElement).getPropertyValue('--accent4').trim();
      return "#ffffff";
    }

    // populate table
    const tbody = document.querySelector("#statesTable tbody");
    Object.keys(statesData).sort().forEach(state => {
      const { cases, deaths } = statesData[state];
      const tr = document.createElement("tr");
      tr.dataset.state = state;
      tr.innerHTML = `<td>${state}</td><td>${cases}</td><td>${deaths}</td>`;
      tr.addEventListener("click", () => openModal(state, cases, deaths, tr));
      tr.addEventListener("mouseover", () => tr.classList.add("hovered"));
      tr.addEventListener("mouseout", () => tr.classList.remove("hovered"));
      tbody.appendChild(tr);
    });

    // modal
    const modal = document.getElementById("modal");
    const modalTitle = document.getElementById("modalTitle");
    const modalCases = document.getElementById("modalCases");
    const modalDeaths = document.getElementById("modalDeaths");
    const modalNotes = document.getElementById("modalNotes");
    const closeModalBtn = document.getElementById("closeModal");

    function openModal(state, cases, deaths, trEl) {
      // mark selection
      document.querySelectorAll("tr.selected").forEach(r => r.classList.remove("selected"));
      trEl.classList.add("selected");

      modalTitle.textContent = state;
      modalCases.textContent = cases;
      modalDeaths.textContent = deaths;
      modalNotes.textContent = (cases === 0) ? "No suspected cases reported in the provided 2020 weekly data (as supplied)." : "Suspected cases counted from aggregated weekly NCDC 2020 reports (as supplied). Death counts were not present in the supplied images.";
      modal.style.display = "flex";
      modal.setAttribute("aria-hidden", "false");
    }

    function closeModal() {
      modal.style.display = "none";
      modal.setAttribute("aria-hidden", "true");
      document.querySelectorAll("tr.selected").forEach(r => r.classList.remove("selected"));
    }
    closeModalBtn.addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });

    // download CSV
    document.getElementById("downloadCsv").addEventListener("click", () => {
      let csv = "State,Suspected_cases,Deaths\\n";
      Object.keys(statesData).sort().forEach(s => {
        const d = statesData[s];
        csv += `"${s}",${d.cases},"${d.deaths}"\\n`;
      });
      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "lassa_cases_by_state_2020.csv";
      document.body.appendChild(a); a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    // accessibility - Esc to close modal
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeModal(); });

  </script>
</body>

</html>